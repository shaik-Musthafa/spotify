<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify Search</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        .container6 {
            margin-top: 20px;
        }
        #results {
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <div class="container6" id="contain">
        <form class="d-flex mt-3" role="search" id="searchForm">
            <input class="form-control me-2" id="searchInput" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Search</button>
        </form>
        
        <h2 id="album">
            <i><a class="popular" style="text-decoration: none; color: #1c1c1c; display: block;" href="#">Popular artists</a></i>
        </h2>
        <a href="#" id="show-all" style="text-decoration: none; color: #1c1c1c;">Show All Artists</a>

        <div id="flexi">
            <!-- Your artist cards go here (as in your provided HTML) -->
            <!-- Example artist card -->
            <div id="card1" class="card">
                <img src="../assets/pritam.png" class="card-img-top" alt="Pritam">
                <img id="btn" src="/assets/play-button.png" class="play" alt="play-button">
                <div class="card-body text-center">
                    <h5 class="card-title">Pritam</h5>
                    <p>Artist</p>
                </div>
            </div>
            <!-- More artist cards... -->
        </div>

        <!-- Results container for search results -->
        <div id="results"></div>
    </div>

    <script>
        async function fetchSearchResults(query) {
            const url = `https://spotify23.p.rapidapi.com/search/?q=${encodeURIComponent(query)}&type=multi&offset=0&limit=10&numberOfTopResults=5`;
            const options = {
                method: 'GET',
                headers: {
                    'x-rapidapi-key': '3820a6b453msh24329ce78bc43fep124d5djsn20ae28943bd1',
                    'x-rapidapi-host': 'spotify23.p.rapidapi.com'
                }
            };
            
            try {
                const response = await fetch(url, options);

                // Check if the response is okay (status 200)
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const result = await response.json(); 
                console.log(result); 

                const resultsContainer = document.getElementById('results');
                resultsContainer.innerHTML = '';

                // Ensure the result format matches your expectations
                if (result.items) {
                    result.items.forEach(item => {
                        const itemDiv = document.createElement('div');
                        itemDiv.classList.add('result-item', 'card', 'mb-3');
                        itemDiv.innerHTML = `
                            <div class="card-body text-center">
                                <h5 class="card-title">${item.name}</h5>
                                <p>Type: ${item.type}</p>
                                <p>URI: ${item.uri}</p>
                            </div>
                        `;
                        resultsContainer.appendChild(itemDiv);
                    });
                } else {
                    resultsContainer.innerHTML = '<p>No results found.</p>';
                }
            } catch (error) {
                console.error('Error fetching search results:', error);
            }
        }

        // Handle form submission
        document.getElementById('searchForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the form from submitting in the traditional way
            const query = document.getElementById('searchInput').value.trim(); // Get the query from the input
            if (query) {
                fetchSearchResults(query); // Call the search function with the input value
            }
        });
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
